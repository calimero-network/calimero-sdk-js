# Builder C Code

This directory contains the C glue code that bridges QuickJS and Calimero host functions.

## Files

- `builder.c` - Main C code that:
  - Initializes QuickJS runtime
  - Registers Calimero host functions
  - Exports contract methods as WASM functions
  
- `code.h` - Generated by QuickJS compiler (qjsc)
  - Contains compiled JavaScript bytecode
  - Auto-generated during build
  
- `methods.h` - Generated by method extractor
  - Contains WASM method exports
  - Auto-generated during build

## Build Process

1. TypeScript → JavaScript (Rollup)
2. JavaScript → `code.h` (QuickJS qjsc)
3. Extract methods → `methods.h` (Babel parser)
4. Compile all → WASM (Clang/WASI-SDK)

## Host Functions

All Calimero host functions are wrapped and exposed as `env.*` in JavaScript:

```javascript
// Available in JavaScript contracts:
env.log_utf8(msg)
env.storage_read(key, register_id)
env.storage_write(key, value, register_id)
env.context_id(register_id)
env.executor_id(register_id)
env.emit(kind, data)
env.commit(root, artifact)
// ... and more
```

## Do Not Edit

- `code.h` and `methods.h` are auto-generated
- Only `builder.c` should be modified if needed

